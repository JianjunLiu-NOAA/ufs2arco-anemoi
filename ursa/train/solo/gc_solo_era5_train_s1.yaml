defaults:
- data: zarr_aifs_era5
- dataloader: native_grid
- datamodule: single
- diagnostics: evaluation
- hardware: slurm
- graph: multi_scale
- model: gnn
- training: default
- _self_

config_validation: True

dataloader:
  batch_size:
    training: 1
    validation: 1
    test: 1    
  training:
    start: 1979
    end: 2022
  validation:
    start: 2023
    end: 2023
  test:
    start: 2023
    end: 2023
  limit_batches:
    training: 100  # null
    validation: 100  # null
  validation_rollout: 1 
   
hardware:
  paths:
    output: ./training-output/
    data: /scratch3/NAGAPE/gpu-ai4wp/Jianjun.Liu/data/era5
    graph: /scratch3/NAGAPE/gpu-ai4wp/Jianjun.Liu/data/era5
  files:
    dataset: era5-o96-1979-2023-6h-v8.zarr  
  num_gpus_per_model: 1

diagnostics:
  callbacks:
    - _target_: anemoi.training.diagnostics.callbacks.evaluation.RolloutEval
      rollout: ${dataloader.validation_rollout}
      every_n_batches: 20

model:
  num_channels: 1024
  bounding:
    - _target_: anemoi.models.layers.bounding.ReluBounding #[0, infinity)
      variables:
      - tp
      - q_50
      - q_100
      - q_150
      - q_200
      - q_250
      - q_300
      - q_400
      - q_500
      - q_600
      - q_700
      - q_850
      - q_925
      - q_1000  
  
training:
  max_epochs: null
  max_steps: 500  # 300,000

  rollout:
    start: 1
    epoch_increment: 0
    max: 1
    
  lr:
    warmup: 1000 
    rate: 3.125e-5
    iterations: 260000
    min: 3e-7 

